const sandBox="https://xmalmorthen.github.io/xmalSign",widgetId="xmalSignWidget";(async e=>{if(e.xmalSign=e.xmalSign||[],e.xmalSign.widget=e.xmalSign.widget||[],!e.xmalSign)return!1;const n=(n,t)=>{try{const o=jQuery?jQuery.noConflict():null,i={image:"",background:"rgba(0, 0, 0, .5)",fontawesome:"fa fa-gear fa-spin",fontawesomeAnimation:"0.7s fade",fontawesomeAutoResize:!1,fontawesomeResizeFactor:2,fontawesomeColor:"#ffcc00"},a=t?"widget"!==t.trim().toLowerCase()?o(t):o(`#${e.xmalSign.config.widgetId}`):o;n?a.LoadingOverlay("show",i):a.LoadingOverlay("hide",!0)}catch(e){}};e.xmalSign.config={sandBox:sandBox,widgetId:widgetId,origin:e.location.origin},await new Promise((e=>{const n=document.getElementsByTagName("head")[0],t=[{id:"xmalSign_fa",src:"https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"}];let o=0;t.forEach((i=>{const a=document.createElement("link");a.id=i.id,a.rel="stylesheet",a.type="text/css",a.href=i.src,a.media="all",a.onload=n=>{o++,o==t.length&&e(!0)},a.onerror=n=>{o++,o==t.length&&e(!0)},n.appendChild(a)}))})),await new Promise((e=>{const n=document.getElementsByTagName("script")[0],t=[{id:"xmalSign_jq",src:"https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"},{id:"xmalSign_lo",src:"https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.1.7/dist/loadingoverlay.min.js"}];let o=0;t.forEach((i=>{const a=document.createElement("script");a.type="text/javascript",a.id=i.id,a.src=i.src,a.onload=n=>{o++,o==t.length&&e(!0)},a.onerror=n=>{o++,o==t.length&&e(!0)},n.parentNode.insertBefore(a,n)}))})),e.xmalSign.widget=t=>{const{appendTo:o}=t;o||alert("Debe especificar el contenedor del widget"),t.frame?.loading?.show&&n(!0,t.frame?.loading?.container);document.getElementById(o).appendChild((t=>{const o=document.createElement("iframe"),i=btoa(t.configurations?JSON.stringify(t.configurations):t.configurations);return o.onload=function(){sendMsg("{status: 1, message: 'frame loaded'}"),n(!1,t.frame?.loading?.container)},o.onerror=function(){sendMsg("{status: 0, message: 'frame not loaded'}"),n(!1,t.frame?.loading?.container)},o.id=e.xmalSign.config.widgetId,o.setAttribute("src",`${e.xmalSign.config.sandBox}/#?wId=${btoa(t?.signToken)}&lo=${btoa(e.location.origin)}&cnfg=${i}`),o.style.width=t.frame?.width||"100%",o.style.height=t.frame?.height||"100vh",o.style.border=t.frame?.border||"none",o.style.padding=t.frame?.padding||"1rem",o})(t)),e.xmalSign.config.ifrm=document.getElementById(e.xmalSign.config.widgetId)},sendMsg=n=>{let t;t="string"!=typeof n?JSON.stringify(n):n,e.xmalSign.config.ifrm.contentWindow.postMessage(t,e.xmalSign.config.sandBox),e.xmalSign.config.ifrm.contentWindow.postMessage(t,location.origin)}})(window);