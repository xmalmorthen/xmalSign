const sandBoxbaseUrl="https://xmalmorthen.github.io",sandBox=`${sandBoxbaseUrl}/xmalSign`,widgetId="xmalSignWidget";(async e=>{if(e.xmalSign=e.xmalSign||[],e.xmalSign.widget=e.xmalSign.widget||[],!e.xmalSign)return!1;const n=(n,a)=>{try{const t=jQuery?jQuery.noConflict():null,o={image:"",background:"rgba(0, 0, 0, .5)",fontawesome:"fa fa-gear fa-spin",fontawesomeAnimation:"0.7s fade",fontawesomeAutoResize:!1,fontawesomeResizeFactor:2,fontawesomeColor:"#ffcc00"},i=a?"widget"!==a.trim().toLowerCase()?t(a):t(`#${e.xmalSign.config.widgetId}`):t;n?i.LoadingOverlay("show",o):i.LoadingOverlay("hide",!0)}catch(e){}};e.xmalSign.config={sandBoxbaseUrl:sandBoxbaseUrl,sandBox:sandBox,widgetId:widgetId,origin:e.location.origin},await new Promise((e=>{const n=document.getElementsByTagName("head")[0],a=[{id:"xmalSign_fa",src:"https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"}];let t=0;a.forEach((o=>{const i=document.createElement("link");i.id=o.id,i.rel="stylesheet",i.type="text/css",i.href=o.src,i.media="all",i.onload=n=>{t++,t==a.length&&e(!0)},i.onerror=n=>{t++,t==a.length&&e(!0)},n.appendChild(i)}))})),await new Promise((e=>{const n=document.getElementsByTagName("script")[0],a=[{id:"xmalSign_jq",src:"https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"},{id:"xmalSign_lo",src:"https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.1.7/dist/loadingoverlay.min.js"}];let t=0;a.forEach((o=>{const i=document.createElement("script");i.type="text/javascript",i.id=o.id,i.src=o.src,i.onload=n=>{t++,t==a.length&&e(!0)},i.onerror=n=>{t++,t==a.length&&e(!0)},n.parentNode.insertBefore(i,n)}))})),e.xmalSign.widget=a=>{const{appendTo:t}=a;t||alert("Debe especificar el contenedor del widget"),a.frame?.loading?.show&&n(!0,a.frame?.loading?.container);document.getElementById(t).appendChild((a=>{const t=document.createElement("iframe"),o=btoa(a.configurations?JSON.stringify(a.configurations):a.configurations);return t.onload=function(){sendMsg("{status: 1, message: 'frame loaded'}"),n(!1,a.frame?.loading?.container)},t.onerror=function(){sendMsg("{status: 0, message: 'frame not loaded'}"),n(!1,a.frame?.loading?.container)},t.id=e.xmalSign.config.widgetId,t.setAttribute("src",`${e.xmalSign.config.sandBox}/#?wId=${btoa(a?.signToken)}&lo=${btoa(e.location.origin)}&cnfg=${o}`),t.style.width=a.frame?.width||"100%",t.style.height=a.frame?.height||"100vh",t.style.border=a.frame?.border||"none",t.style.padding=a.frame?.padding||"1rem",t})(a)),e.xmalSign.config.ifrm=document.getElementById(e.xmalSign.config.widgetId)},sendMsg=n=>{let a;a="string"!=typeof n?JSON.stringify(n):n,e.xmalSign.config.ifrm.contentWindow.postMessage(a,e.xmalSign.config.sandBoxbaseUrl)}})(window);